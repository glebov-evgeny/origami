import{s as N,d as S,r as u,o as i,c as _,b as t,t as m,u as a,x as B,p as k,v as w,q as A,y as f,z as C,A as I,_ as R,a as Z}from"./entry.ecc31ec4.js";import{u as M}from"./cookie.3573b756.js";import{u as P}from"./user.25d3d334.js";const T={class:"s-auth"},W={class:"s-auth__container l-wide"},q={class:"s-auth__title"},z={class:"s-auth__formbox"},L=["onSubmit"],$={class:"s-auth__form-label"},j={class:"s-auth__form-label"},G={type:"submit",class:"s-auth__form-button"},H={key:0,class:"s-auth__form-error"},J={key:0,class:"s-auth__form-error-text"},K={key:1,class:"s-auth__form-error-text"},O={key:2,class:"s-auth__form-error-text"},Q={class:"s-auth__changebox"},X=t("span",{class:"s-auth__text"},"или",-1),Y={__name:"s-auth",setup(E){const v=N(),d=P(),x=S(),y=M("userInformation",{default:()=>null,watch:"shallow"});let n=u(!0),e=u(""),r=u(""),l=u(!1),p=u(!1),g=u(!1),b=u(!1),h=u("");const U=()=>n.value=!n.value,F=async()=>{if(!e.value.trim()||!r.value.trim()){l.value=!0;return}const s=/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i;if(e.value&&!s.test(e.value)){l.value=!0,p.value=!0;return}if(r.value.length<6){l.value=!0,p.false=!1,g.value=!0;return}l.value=!1,n.value==!0?D():V()},V=async()=>{try{const s=await C(v,e.value,r.value);d.setUser(e.value,s.user.uid);const o={email:e.value,id:s.user.uid,maxAge:60*60*24*7};y.value=o,x.push({path:"/lk"})}catch(s){l.value=!0,b.value=!0,s.message==="Firebase: Error (auth/email-already-in-use)."&&(h.value="Почта уже зарегистрирована.")}},D=async()=>{try{const s=await I(v,e.value,r.value);d.setUser(e.value,s.user.uid);const o={email:e.value,id:s.user.uid,maxAge:60*60*24*7};y.value=o,x.push({path:"/lk"})}catch(s){l.value=!0,b.value=!0,s.message==="Firebase: Error (auth/email-already-in-use)."?h.value="Почта уже зарегистрирована.":s.message==="Firebase: Error (auth/invalid-login-credentials)."&&(h.value="Пользователь не найден")}};return(s,o)=>(i(),_("section",T,[t("div",W,[t("h1",q,m(a(n)?"Войти":"Регистрация"),1),t("div",z,[t("form",{class:"s-auth__form",onSubmit:B(F,["prevent"])},[t("label",$,[k(t("input",{"onUpdate:modelValue":o[0]||(o[0]=c=>A(e)?e.value=c:e=c),class:"s-auth__form-input",type:"text",placeholder:"Почта"},null,512),[[w,a(e)]])]),t("label",j,[k(t("input",{"onUpdate:modelValue":o[1]||(o[1]=c=>A(r)?r.value=c:r=c),class:"s-auth__form-input",type:"password",placeholder:"Пароль"},null,512),[[w,a(r)]])]),t("button",G,m(a(n)?"Вход":"Зарегистрироваться"),1),a(l)?(i(),_("div",H,[a(p)?(i(),_("p",J,"Укажите корректную почту")):f("",!0),a(g)?(i(),_("p",K,"Пароль должен быть из 6 и более символов")):f("",!0),a(b)?(i(),_("p",O,m(a(h)),1)):f("",!0)])):f("",!0)],40,L),t("div",Q,[X,t("button",{class:"s-auth__button",onClick:U},m(a(n)?"Регистрация":"Войти"),1)])])])]))}},ee={},se={class:"s-main"};function te(E,v){const d=Y;return i(),_("main",se,[Z(d)])}const ue=R(ee,[["render",te]]);export{ue as default};
